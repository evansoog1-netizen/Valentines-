<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Be My Valentine ğŸ’›</title>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
:root{
 --bg-light: linear-gradient(135deg,#ff9a9e,#fad0c4);
 --bg-dark: linear-gradient(135deg,#111,#333);
}
body{
 margin:0;
 font-family:Arial, sans-serif;
 display:flex;
 justify-content:center;
 align-items:center;
 height:100vh;
 overflow:hidden;
 background:var(--bg-light);
 transition:.4s;
}
.dark{ background:var(--bg-dark); color:white; }
.container{
 background:white;
 width:95%;
 max-width:440px;
 padding:20px;
 border-radius:20px;
 text-align:center;
 box-shadow:0 10px 30px rgba(0,0,0,.3);
 position:relative;
 overflow:hidden;
}
.dark .container{ background:#222; }

.buttons{ position:relative; height:100px; margin-top:15px; }
button{
 padding:10px 20px;
 border:none;
 border-radius:30px;
 font-size:16px;
 cursor:pointer;
 position:absolute;
 transition:.3s;
}
#yesBtn{ background:#ff4d6d; color:white; left:20%; }
#noBtn{ background:#444; color:white; right:20%; }

.yay{
 display:none;
 font-size:30px;
 font-weight:bold;
 color:#ff0066;
 margin-top:10px;
 animation:pop .6s infinite alternate;
}
@keyframes pop{ from{transform:scale(1);} to{transform:scale(1.2);} }

.toggle{
 position:absolute;
 top:10px;
 right:15px;
 cursor:pointer;
 font-size:14px;
}

.heartFloat{
 position:fixed;
 color:red;
 animation:floatUp 6s linear infinite;
 font-size:20px;
 pointer-events:none;
}
@keyframes floatUp{
 from{transform:translateY(100vh);opacity:1;}
 to{transform:translateY(-10vh);opacity:0;}
}

.stats{ font-size:13px; margin-top:6px; }

.ticker{
 margin-top:6px;
 font-size:13px;
 color:#ff0066;
 font-weight:bold;
}

.whatsapp{
 display:inline-block;
 margin-top:8px;
 padding:8px 15px;
 background:#25D366;
 color:white;
 border-radius:20px;
 text-decoration:none;
 font-size:14px;
}
</style>
</head>
<body>

<div class="container">

<div class="toggle" onclick="toggleDark()">ğŸŒ™ Toggle</div>

<svg width="120" height="160" viewBox="0 0 200 260">
<rect x="40" y="40" rx="60" ry="60" width="120" height="160" fill="yellow"/>
<circle cx="100" cy="100" r="35" fill="white" stroke="#555" stroke-width="8"/>
<circle cx="100" cy="100" r="15" fill="black">
<animate attributeName="r" values="15;13;15" dur="1s" repeatCount="indefinite"/>
</circle>
<text x="100" y="190" font-size="40" text-anchor="middle" fill="red">â¤</text>
</svg>

<input type="text" id="nameInput" placeholder="Enter their name">

<h2 id="question">Will you be my Valentine? ğŸ’–</h2>

<div class="buttons">
<button id="yesBtn">Yes ğŸ’•</button>
<button id="noBtn">No ğŸ˜¢</button>
</div>

<div class="yay" id="yayText">YAYYY!! ğŸ‰ğŸ’–</div>

<div class="stats" id="visitorCount">Visitors: Loading...</div>
<div class="stats" id="liveUsers">ğŸŸ¢ Live Users: Connecting...</div>

<div class="stats">
ğŸŒ Visitors by Country:
<div id="countryList">Loading...</div>
</div>

<div class="stats">
ğŸ’– She Said YES: <span id="yesTotal">0</span>
</div>

<div class="stats">
ğŸ’˜ YES by Country:
<div id="yesCountryList">Loading...</div>
</div>

<div class="ticker" id="lastYesTicker">
ğŸ”¥ Waiting for someone to say YES...
</div>

<a class="whatsapp" href="https://wa.link/u6b8a9" target="_blank">
ğŸ’¬ Chat on WhatsApp
</a>

</div>

<audio id="bgMusic" loop>
<source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_8bde3e4d75.mp3?filename=romantic-background-112191.mp3">
</audio>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, set, onValue, onDisconnect } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

/* ğŸ”¥ REPLACE WITH YOUR FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_AUTH_DOMAIN",
  databaseURL: "YOUR_DATABASE_URL",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_STORAGE_BUCKET",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* ===== URL NAME SUPPORT ===== */
const params=new URLSearchParams(window.location.search);
const nameInput=document.getElementById("nameInput");
const question=document.getElementById("question");

if(params.get("name")){
 let n=params.get("name");
 nameInput.value=n;
 question.innerText="Will you be my Valentine, "+n+"? ğŸ’–";
}

nameInput.addEventListener("input",()=>{
 if(nameInput.value.trim()!==""){
  question.innerText="Will you be my Valentine, "+nameInput.value+"? ğŸ’–";
 } else {
  question.innerText="Will you be my Valentine? ğŸ’–";
 }
});

/* ===== YES / NO ===== */
let noBtn=document.getElementById("noBtn");
let yesBtn=document.getElementById("yesBtn");
let yay=document.getElementById("yayText");
let bgMusic=document.getElementById("bgMusic");
let scale=1;

function moveNo(){
 const container=document.querySelector(".buttons");
 const maxX=container.clientWidth-noBtn.offsetWidth;
 const maxY=container.clientHeight-noBtn.offsetHeight;
 noBtn.style.left=Math.random()*maxX+"px";
 noBtn.style.top=Math.random()*maxY+"px";
 scale+=0.1;
 yesBtn.style.transform="scale("+scale+")";
}
noBtn.addEventListener("mouseover",moveNo);
noBtn.addEventListener("touchstart",moveNo);

yesBtn.addEventListener("click", async ()=>{
 yay.style.display="block";
 yesBtn.style.display="none";
 noBtn.style.display="none";
 bgMusic.play();

 let end=Date.now()+4000;
 (function frame(){
  confetti({particleCount:6,spread:70,origin:{y:0.6}});
  if(Date.now()<end){requestAnimationFrame(frame);}
 })();

 try{
   const geoRes=await fetch("https://ipapi.co/json/");
   const geo=await geoRes.json();
   const country=geo.country_name||"Unknown";
   const time=new Date().toLocaleString();

   fetch("https://api.countapi.xyz/hit/karlos-valentine-2026/yesTotal")
   .then(r=>r.json())
   .then(d=>{ set(ref(db,"yesStats/total"),d.value); });

   fetch(`https://api.countapi.xyz/hit/karlos-valentine-2026/yes-${country}`)
   .then(r=>r.json())
   .then(d=>{ set(ref(db,"yesStats/countries/"+country),d.value); });

   // Save last YES event
   set(ref(db,"yesStats/lastYes"),{
     country:country,
     time:time
   });

 }catch{}
});

/* ===== FLOATING HEARTS ===== */
setInterval(()=>{
 let heart=document.createElement("div");
 heart.className="heartFloat";
 heart.style.left=Math.random()*100+"vw";
 heart.innerText="â¤";
 document.body.appendChild(heart);
 setTimeout(()=>heart.remove(),6000);
},800);

/* ===== DARK MODE ===== */
window.toggleDark=function(){
 document.body.classList.toggle("dark");
}

/* ===== TOTAL VISITORS ===== */
fetch("https://api.countapi.xyz/hit/karlos-valentine-2026/total")
.then(r=>r.json())
.then(d=>{
 document.getElementById("visitorCount").innerText="Visitors: "+d.value;
});

/* ===== LIVE USERS ===== */
const userId=crypto.randomUUID();
const userRef=ref(db,"onlineUsers/"+userId);
set(userRef,true);
onDisconnect(userRef).remove();

onValue(ref(db,"onlineUsers"),snap=>{
 const count=snap.val()?Object.keys(snap.val()).length:0;
 document.getElementById("liveUsers").innerText="ğŸŸ¢ Live Users: "+count;
});

/* ===== COUNTRY VISIT STATS ===== */
async function trackCountry(){
 try{https://github.com/evansoog1-netizen/Valentines-/tree/main
  const response=await fetch("https://ipapi.co/json/");
  const geo=await response.json();
  const country=geo.country_name||"Unknown";
  fetch(`https://api.countapi.xyz/hit/karlos-valentine-2026/${country}`)
  .then(r=>r.json())
  .then(d=>{ set(ref(db,"countries/"+country),d.value); });
 }catch{}
}
trackCountry();

onValue(ref(db,"countries"),snap=>{
 const data=snap.val();
 const list=document.getElementById("countryList");
 if(!data){ list.innerHTML="No data yet"; return; }
 let html="";
 Object.entries(data).sort((a,b)=>b[1]-a[1])
 .forEach(([c,v])=>{ html+=`<div>${c}: ${v}</div>`; });
 list.innerHTML=html;
});

/* ===== YES STATS ===== */
onValue(ref(db,"yesStats/total"),snap=>{
 document.getElementById("yesTotal").innerText=snap.val()||0;
});

onValue(ref(db,"yesStats/countries"),snap=>{
 const data=snap.val();
 const list=document.getElementById("yesCountryList");
 if(!data){ list.innerHTML="No YES yet"; return; }
 let html="";
 Object.entries(data).sort((a,b)=>b[1]-a[1])
 .forEach(([c,v])=>{ html+=`<div>${c}: ${v}</div>`; });
 list.innerHTML=html;
});

/* ===== LAST YES TICKER ===== */
onValue(ref(db,"yesStats/lastYes"),snap=>{
 const data=snap.val();
 const ticker=document.getElementById("lastYesTicker");
 if(!data){
  ticker.innerText="ğŸ”¥ Waiting for someone to say YES...";
 }else{
  ticker.innerText=`ğŸ’˜ Last YES from ${data.country} at ${data.time}`;
 }
});

/* ===== SURPRISE MODE ===== */
document.addEventListener("keydown",e=>{
 if(e.key==="s"){
  let pass=prompt("Enter surprise password:");
  if(pass==="love123"){
   document.body.style.background="hotpink";
   alert("Surprise Mode Activated ğŸ’˜");
  }
 }
});

</script>
</body>
</html>
